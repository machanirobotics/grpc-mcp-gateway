# mcp/protobuf (Go)

Pre-compiled Protocol Buffer types for [grpc-mcp-gateway](https://github.com/machanirobotics/grpc-mcp-gateway) — the `mcp.protobuf` package containing MCP annotations for gRPC services.

## Install

```bash
go get github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf/mcppb
```

Or with the parent package (registers proto extensions):

```bash
go get github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf
```

## Packages

| Import path | Purpose |
| ----------- | ------- |
| `github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf/mcppb` | Generated protobuf types (`MCPServiceOptions`, `MCPToolOptions`, `MCPPrompt`, `MCPElicitation`, etc.) |
| `github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf` | Blank import for side effects — registers proto extensions on `ServiceOptions` and `MethodOptions` |

## Usage

### In your `.proto` files

Add the MCP annotations to your service and RPCs:

```protobuf
syntax = "proto3";
package myapp.v1;

import "mcp/protobuf/annotations.proto";

service MyService {
  option (mcp.protobuf.service) = {
    app: { name: "My App" version: "1.0.0" description: "..." }
  };

  rpc DoSomething(DoSomethingRequest) returns (DoSomethingResponse) {
    option (mcp.protobuf.tool) = {
      description: "Does something useful."
    };
  }
}
```

For server-streaming with progress, import `mcp/protobuf/progress.proto` and use `MCPProgress` in a oneof with your result type (see [Progress](https://github.com/machanirobotics/grpc-mcp-gateway#progress-server-streaming) in the main README).

### In generated Go code

Code generated by `protoc-gen-go` that imports MCP-annotated protos will have:

```go
import _ "github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf"
```

This blank import registers the extension fields so `proto.GetExtension()` and reflection work correctly. If you compile protos manually, ensure this import is present (or import `mcppb` directly).

### Direct use of types

```go
import "github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf/mcppb"

// Access MCP options from descriptors
opts := proto.GetExtension(desc.Options(), mcppb.E_Service).(*mcppb.MCPServiceOptions)
```

## What's included

| Type | Description |
| ---- | ----------- |
| `MCPServiceOptions` | App metadata (name, version, description) |
| `MCPToolOptions` | Tool name/description overrides |
| `MCPPrompt` | Prompt template (name, description, schema) |
| `MCPElicitation` | Confirmation dialog (message, schema) |
| `MCPResource` | Resource definition (uri, pattern, mime type) |
| `MCPApp` | App info for MCP Apps |
| `MCPFieldOptions` | Field description, examples, format, deprecated |
| `MCPEnumOptions`, `MCPEnumValueOptions` | Enum and enum-value descriptions |
| `MCPProgress` | Progress notifications for server-streaming RPCs |
| `MCPMimeType`, `MCPFieldType` | Enums |

## Publishing

This package is part of the [grpc-mcp-gateway](https://github.com/machanirobotics/grpc-mcp-gateway) module. It is published automatically when you:

```bash
go get github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf/mcppb@latest
```

Documentation appears on [pkg.go.dev](https://pkg.go.dev/github.com/machanirobotics/grpc-mcp-gateway/mcp/protobuf/mcppb).

## Links

- **Source**: [github.com/machanirobotics/grpc-mcp-gateway](https://github.com/machanirobotics/grpc-mcp-gateway)
- **Proto definitions**: [buf.build/machanirobotics/grpc-mcp-gateway](https://buf.build/machanirobotics/grpc-mcp-gateway)
- **License**: Apache-2.0
