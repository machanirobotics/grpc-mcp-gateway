// Code generated by protoc-gen-mcp. DO NOT EDIT.
// versions:
// 	protoc-gen-mcp v1.4.1-0.20260226140831-4ca3558529bb+dirty
// Authors: Machani Robotics - Open Source 2026
// source: counter/v1/counter_service.proto

#[cxx::bridge(namespace = "counter::v1")]
mod ffi_counter_service {
    unsafe extern "C++" {
        include!("counter/v1/counter_service.mcp.h");

        type CounterServiceMcpImpl;

        fn new_counter_service_mcp() -> UniquePtr<CounterServiceMcpImpl>;
    }

    extern "Rust" {
        fn start_counter_service_mcp_http(host: &str, port: u16, base_path: &str);
        fn start_counter_service_mcp_stdio();
    }
}

pub mod mcp_handler;

fn start_counter_service_mcp_http(host: &str, port: u16, base_path: &str) {
    let rt = tokio::runtime::Runtime::new().expect("failed to create tokio runtime");
    rt.block_on(async {
        if let Err(e) = mcp_handler::serve_counter_service_mcp(host, port, base_path).await {
            eprintln!("MCP HTTP server failed: {e}");
            eprintln!("Hint: Port {port} may be in use. Try MCP_PORT=8083 ./server or kill the process using the port.");
            std::process::exit(1);
        }
    });
}

fn start_counter_service_mcp_stdio() {
    let rt = tokio::runtime::Runtime::new().expect("failed to create tokio runtime");
    rt.block_on(async {
        mcp_handler::serve_counter_service_mcp_stdio()
            .await
            .expect("MCP stdio server failed");
    });
}

