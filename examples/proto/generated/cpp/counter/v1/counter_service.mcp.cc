// Code generated by protoc-gen-mcp. DO NOT EDIT.
// versions:
// 	protoc-gen-mcp v1.3.4-0.20260225060520-7b3b28c62629+dirty
// Authors: Machani Robotics - Open Source 2026
// source: counter/v1/counter_service.proto

#include "counter/v1/counter_service.mcp.h"

#include <grpcpp/grpcpp.h>
#include <google/protobuf/util/json_util.h>

namespace counter { namespace v1 {

static std::string _mcp_error_json(const std::string& msg) {
    std::string escaped;
    escaped.reserve(msg.size());
    for (char c : msg) {
        if (c == '"') escaped += "\\\"";
        else if (c == '\\') escaped += "\\\\";
        else if (c == '\n') escaped += "\\n";
        else escaped += c;
    }
    return "{\"error\":\"" + escaped + "\"}";
}

static std::string _mcp_msg_to_json(const ::google::protobuf::Message& msg) {
    std::string json;
    ::google::protobuf::util::JsonPrintOptions opts;
    opts.preserve_proto_field_names = true;
    auto st = ::google::protobuf::util::MessageToJsonString(msg, &json, opts);
    if (!st.ok()) return _mcp_error_json(std::string(st.message()));
    return json;
}

CounterServiceMcpImpl::CounterServiceMcpImpl(std::shared_ptr<CounterService::Stub> stub)
    : stub_(std::move(stub)) {}

std::unique_ptr<CounterServiceMcpImpl> new_counter_service_mcp() {
    auto channel = ::grpc::CreateChannel(
        "localhost:50051", ::grpc::InsecureChannelCredentials());
    auto stub = CounterService::NewStub(channel);
    return std::make_unique<CounterServiceMcpImpl>(std::move(stub));
}

} } // namespace counter::v1
